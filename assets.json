{"chapter.xhtml.ejs":"<?xml version=\"1.0\" encoding=\"UTF-8\"?> <!DOCTYPE html> <html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:epub=\"http://www.idpf.org/2007/ops\" xml:lang=\"<%= lang %>\" lang=\"<%= lang %>\"> <head> <meta charset=\"UTF-8\" /> <title> <%= title %> </title> <link rel=\"stylesheet\" type=\"text/css\" href=\"style.css\" /> </head> <body> <% if (prependChapterTitles) { %> <h1> <%= title %> </h1> <% if (author.length) { %> <p class=\"epub-author\"> <%= author.join(', ') %></p> <% } %> <% if (url) { %> <p class=\"epub-link\"><a href=\"<%= url %>\"><%= url %></a></p> <% } %> <% } %> <%- content %> </body> </html>","content.opf.ejs":"<?xml version=\"1.0\" encoding=\"UTF-8\"?> <package xmlns=\"http://www.idpf.org/2007/opf\" version=\"3.0\" unique-identifier=\"BookId\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:dcterms=\"http://purl.org/dc/terms/\" xml:lang=\"en\" xmlns:media=\"http://www.idpf.org/epub/vocab/overlays/#\" prefix=\"ibooks: http://vocabulary.itunes.apple.com/rdf/ibooks/vocabulary-extensions-1.0/\"> <metadata xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:opf=\"http://www.idpf.org/2007/opf\"> <dc:identifier id=\"BookId\"><%= id %></dc:identifier> <meta refines=\"#BookId\" property=\"identifier-type\" scheme=\"onix:codelist5\">22</meta> <meta property=\"dcterms:identifier\" id=\"meta-identifier\">BookId</meta> <dc:title><%= title %></dc:title> <meta property=\"dcterms:title\" id=\"meta-title\"><%= title %></meta> <dc:language><%= lang %></dc:language> <meta property=\"dcterms:language\" id=\"meta-language\"><%= lang %></meta> <meta property=\"dcterms:modified\"><%= (new Date()).toISOString().split(\".\")[0]+ \"Z\" %></meta> <dc:creator id=\"creator\"><%= author.join(\",\") %></dc:creator> <meta refines=\"#creator\" property=\"file-as\"><%= author.join(\",\") %></meta> <meta property=\"dcterms:publisher\"><%= publisher %></meta> <dc:publisher><%= publisher %></dc:publisher> <meta property=\"dcterms:date\"><%= date %></meta> <dc:date><%= date %></dc:date> <meta property=\"dcterms:rights\">All rights reserved</meta> <dc:rights>Copyright &#x00A9; <%= (new Date()).getFullYear() %> by <%= publisher %></dc:rights> <% if(cover) { %> <meta name=\"cover\" content=\"image_cover\" /> <% } %> </metadata> <manifest> <item id=\"css\" href=\"style.css\" media-type=\"text/css\" /> <item id=\"ncx\" href=\"toc.ncx\" media-type=\"application/x-dtbncx+xml\" /> <item id=\"toc\" href=\"toc.xhtml\" media-type=\"application/xhtml+xml\" properties=\"nav\" /> <% if(cover) { %> <item id=\"cover.xhtml\" href=\"cover.xhtml\" media-type=\"application/xhtml+xml\" /> <item id=\"image_cover\" href=\"cover.<%= cover.extension %>\" media-type=\"<%= cover.mediaType %>\" properties=\"cover-image\" /> <% } %> <% for (let index=0; index < images.length; index++){ %> <item id=\"image_<%= index %>\" href=\"images/<%= images[index].id %>.<%= images[index].extension %>\" media-type=\"<%= images[index].mediaType %>\" /> <% } %> <% for (let index=0; index < content.length; index++){ %> <item id=\"content_<%= index %>_<%= content[index].id %>\" href=\"<%= content[index].filename %>\" media-type=\"application/xhtml+xml\" /> <% } %> <% for (let index=0; index < fonts.length; index++){ %> <item id=\"font_<%= index %>\" href=\"fonts/<%= fonts[index].filename %>\" media-type=\"<%= fonts[index].mediaType %>\" /> <% } %> </manifest> <spine toc=\"ncx\"> <% if (cover) { %> <itemref idref=\"cover.xhtml\" /> <% } %> <itemref idref=\"toc\" /> <% for (let index=0; index < content.length; index++){ %> <% if(content[index].beforeToc){ %> <itemref idref=\"content_<%= index %>_<%= content[index].id %>\" /> <% } %> <% } %> <% for (let index=0; index < content.length; index++){ %> <% if(!content[index].beforeToc){ %> <itemref idref=\"content_<%= index %>_<%= content[index].id %>\" /> <% } %> <% } %> </spine> <guide> <% if (cover) { %> <reference type=\"cover\" title=\"Cover\" href=\"cover.xhtml\" /> <% } %> <reference type=\"text\" title=\"Table of Content\" href=\"toc.xhtml\" /> </guide> </package> ","cover.xhtml.ejs":"<?xml version=\"1.0\" encoding=\"UTF-8\"?> <!DOCTYPE html> <html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:epub=\"http://www.idpf.org/2007/ops\" lang=\"en\" xml:lang=\"en\"> <head> <title> <%= title %> </title> <style> body { margin: 0em; padding: 0em; } img { max-width: 100%; max-height: 100%; } </style> </head> <body> <div style=\"text-align: center; padding: 0pt; margin: 0pt;\"> <% if (cover) { %> <img src=\"cover.<%= cover.extension %>\" alt=\"Cover\" /> <% } %> </div> </body> </html>","make.ts":"Deno.chdir(import.meta.dirname!); const files: Record<string, string> = {}; for (const file of Deno.readDirSync(\".\")) { if (file.name === import.meta.filename!) continue; files[file.name] = Deno.readTextFileSync(file.name).replaceAll(/\\s+/g, ' '); } const out = '../assets.json'; Deno.writeTextFileSync(out, JSON.stringify(files)); console.log(`Wrote ${Object.keys(files).length} files to ${out}`);","template.css":".epub-author { color: #555; } .epub-link { margin-bottom: 30px; } .epub-link a { color: #666; font-size: 90%; } .toc-author { font-size: 90%; color: #555; } .toc-link { color: #999; font-size: 85%; display: block; } hr { border: 0; border-bottom: 1px solid #dedede; margin: 60px 10%; } ","toc.ncx.ejs":"<?xml version=\"1.0\" encoding=\"UTF-8\"?> <ncx xmlns=\"http://www.daisy.org/z3986/2005/ncx/\" version=\"2005-1\"> <head> <meta name=\"dtb:uid\" content=\"<%= id %>\" /> <meta name=\"dtb:generator\" content=\"deno.epubgen\" /> <meta name=\"dtb:depth\" content=\"1\" /> <meta name=\"dtb:totalPageCount\" content=\"0\" /> <meta name=\"dtb:maxPageNumber\" content=\"0\" /> </head> <docTitle> <text> <%= title %> </text> </docTitle> <docAuthor> <text> <%= author %> </text> </docAuthor> <navMap> <% var _index=1; %> <% if (cover){ %> <navPoint id=\"cover\" playOrder=\"0\"> <navLabel> <text>Cover</text> </navLabel> <content src=\"cover.xhtml\" /> </navPoint> <% } %> <navPoint id=\"toc\" playOrder=\"<%= _index++ %>\" class=\"chapter\"> <navLabel> <text> <%= tocTitle %> </text> </navLabel> <content src=\"toc.xhtml\" /> </navPoint> <% for (let i=_index; i < content.length; i++){ %> <% if(!content[i].excludeFromToc && content.beforeToc){ %> <navPoint id=\"content_<%= i %>_<%= content[i].id %>\" playOrder=\"<%= i++ %>\" class=\"chapter\"> <navLabel> <text> <%= (numberChaptersInTOC ? (1 + i) + \". \" : \"\" ) + (content[i].title || \"Chapter \" + (1+i)) %> </text> </navLabel> <content src=\"<%= content[i].filename %>\" /> </navPoint> <% } %> <% } %> </navMap> </ncx>","toc.xhtml.ejs":"<!DOCTYPE html> <html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:epub=\"http://www.idpf.org/2007/ops\" xml:lang=\"<%- lang %>\" lang=\"<%- lang %>\"> <head> <title> <%= title %> </title> <meta charset=\"UTF-8\" /> <link rel=\"stylesheet\" type=\"text/css\" href=\"style.css\" /> </head> <body> <h1 class=\"h1\"> <%= tocTitle %> </h1> <nav id=\"toc\" epub:type=\"toc\"> <% if (numberChaptersInTOC){ %> <ol> <% }else{ %> <ol style=\"list-style: none\"> <% } %> <% for (let index=0; index < content.length; index++){ %> <% if(!content[index].excludeFromToc){ %> <li class=\"table-of-content\"> <a href=\"<%= content[index].filename %>\"> <%= (content[index].title || \"Chapter \" + (1+index)) %> <% if(content[index].author.length){ %> - <small class=\"toc-author\"> <%= content[index].author.join(\",\") %> </small> <% }%> <% if(content[index].url){ %> <span class=\"toc-link\"> <%= content[index].url %> </span> <% }%> </a> </li> <% } %> <% } %> </ol> </nav> </body> </html>"}